.TH SSHELL-DAEMON 8 "February 2026" "SShell 1.6.2" "System Administration"
.SH NAME
sshell-daemon \- SShell session management daemon
.SH SYNOPSIS
.B sshell-daemon
[\fI\,--no-fork\/\fR] [\fI\,OPTIONS\/\fR]
.SH DESCRIPTION
.B sshell-daemon
is the background daemon that manages persistent shell sessions for SShell.
It handles session creation, attachment, detachment, and cleanup.
.PP
The daemon is typically started automatically by the \fBsshell\fR client when
needed. It can also be run as a systemd user service for automatic startup.
.SH OPTIONS
.TP
.B \-\-no-fork
Do not daemonize. Run in foreground (useful for debugging).
.TP
.B \-\-tcp
Listen on TCP (default).
.TP
.B \-\-unix
Listen on a Unix domain socket.
.TP
.B \-\-host \fI\,HOST\/\fR
Bind host/IP for TCP mode (default: 0.0.0.0).
.TP
.B \-\-port \fI\,PORT\/\fR
Bind TCP port (default: 7444).
.TP
.B \-\-ufw-auto
Attempt to open the TCP port in UFW (requires root and ufw installed).
.TP
.B \-\-wallet \fI\,ADDRESS\/\fR
Require MetaMask/Ethereum signature authentication and only allow this wallet address.
.TP
.B \-\-wallet-allowlist \fI\,PATH\/\fR
Require wallet authentication and restrict to addresses in a file (one per line).
.TP
.B \-\-ssh-allowlist \fI\,PATH\/\fR
Allow SSH-key style identities from a file (one per line).
.TP
.B \-\-insecure-no-auth
Disable auth checks (NOT recommended).
.TP
.B \-\-log-level \fI\,LEVEL\/\fR
Log verbosity (debug|info|warn|error).
.TP
.B \-\-debug
Alias for \fB--log-level debug\fR.
.SH SIGNALS
.TP
.B SIGTERM, SIGINT
Gracefully shutdown the daemon. All sessions are preserved and can be
reattached after the daemon restarts.
.TP
.B SIGCHLD
Handled internally to track session process termination.
.TP
.B SIGALRM
Triggers periodic cleanup of dead and idle sessions.
.SH FILES
.TP
.I ~/.sshell/daemon.sock
Unix domain socket for client communication.
.TP
.I ~/.sshell/daemon.pid
Contains the PID of the running daemon.
.TP
.I ~/.sshell/daemon.log
Log file for daemon messages.
.TP
.I ~/.sshell/sessions/*.json
Session metadata files.
.SH CONFIGURATION
The daemon behavior can be customized by modifying the configuration
in ~/.sshell/config (if implemented).
.PP
If the file \fI~/.sshell/daemon.json\fR exists, the daemon loads preset defaults
from it at startup (CLI flags override). Example:
.PP
.nf
{
	"mode": "tcp",
	"host": "0.0.0.0",
	"port": 7444,
	"ufw_auto": true,
	"auth_required": true,
	"wallet": "0x...",
	"log_level": "info"
}
.fi
.TP
.B max_sessions
Maximum number of concurrent sessions per user (default: 10).
.TP
.B session_timeout
Idle timeout in seconds for sessions (0 = no timeout, default: 0).
.TP
.B auto_cleanup_dead
Automatically remove dead sessions (default: true).
.SH SECURITY
The daemon runs with the same privileges as the user who started it.
Session data and the communication socket are protected with 0600 permissions,
ensuring only the owning user can access sessions.
.PP
When running in TCP mode, you should enable authentication (for example, using
\fB--wallet\fR or a wallet allowlist) before binding to non-local interfaces.
.PP
Multi-user sharing uses short-lived share tokens generated by an authenticated
inviter. Guests join using a token (\fIsshell share-TOKEN@host\fR). The inviter
can revoke access with \fIsshell --stopshare\fR, which disconnects guest users.
.SH SYSTEMD INTEGRATION
To run as a systemd user service:
.PP
.nf
.RS
systemctl --user enable sshell
systemctl --user start sshell
.RE
.fi
.SH EXIT STATUS
.TP
.B 0
Daemon shutdown gracefully
.TP
.B 1
Error occurred during startup
.SH SEE ALSO
.BR sshell (1),
.BR systemd (1)
.SH BUGS
Report bugs at https://github.com/d31337m3/sshell
.SH AUTHOR
SShell was written as a learning project for PTY management and session persistence.
